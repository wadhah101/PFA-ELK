# Alert when the rate of events exceeds a threshold

# (Optional)
# Elasticsearch host
# es_host: elasticsearch.example.com

# (Optional)
# Elasticsearch port
# es_port: 14900

# (OptionaL) Connect with SSL to Elasticsearch
#use_ssl: True

# (Optional) basic-auth username and password for Elasticsearch
#es_username: someusername
#es_password: somepassword

# (Required)
# Rule name, must be unique
name: Example frequency rule

# (Required)
# Type of alert.
# the frequency rule type alerts when num_events events occur with timeframe time
type: frequency

# (Required)
# Index to search, wildcard supported
index: metricbeat-*

# (Required, frequency specific)
# Alert when this many documents matching the query occur within a timeframe
num_events: 2

# (Required, frequency specific)
# num_events must occur within this amount of time to trigger an alert
timeframe:
  hours: 4

# (Required)
# A list of Elasticsearch filters used for find events
# These filters are joined with AND and nested in a filtered query
# For more info: https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html
filter:
  - term:
      some_field: "some_value"

alert: hivealerter

hive_connection:
  hive_host: http://thehive
  hive_port: 9000
  hive_apikey: Pkcf/ereoqLjI6BrP5kn/54a2xsVt4xC

hive_alert_config:
  customFields:
    - name: example
      type: string
      value: example
  follow: True
  severity: 2
  status: "New"
  source: "elastalert"
  description_args: [name, description]
  description: "{0} : {1}"
  tags: ["tag1", "tag2"]
  title: "Title"
  tlp: 3
  type: "external"

hive_observable_data_mapping:
  - domain: agent.hostname
    tlp: 1
    tags: ["tag1", "tag2"]
    message: "agent hostname"
  - domain: response.domain
    tlp: 2
    tags: ["tag3"]
  - ip: client.ip
