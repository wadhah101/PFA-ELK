name: SSH abuse - ElastAlert 3.0.1
is_enabled: true

# Alert on x events in y seconds
type: frequency

num_events: 10

timeframe:
  minutes: 30

filter:
  - query:
      query_string:
        query: "event.type:authentication_failure"

index: auditbeat-*

realert:
  minutes: 1

query_key:
  - source.ip

include:
  - host.hostname
  - user.name
  - source.ip

include_match_in_root: true

alert_subject: "SSH abuse on <{}>"
alert_subject_args:
  - host.hostname

alert_text: |-
  An attack on {} is detected.
  The attacker looks like:
  User: {}
  IP: {}
alert_text_args:
  - host.hostname
  - user.name
  - source.ip

alert:
  - debug
